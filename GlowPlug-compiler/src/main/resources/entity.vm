package ${packageName};

import com.adecker.glowplugcompiler.GlowplugAttribute;
import com.adecker.glowplugcompiler.GlowplugEntity;
import com.adecker.glowplugcompiler.GlowplugRelationship;

public class ${className}Entity extends GlowplugEntity{
    public static final String TABLE_NAME = "${tableName}";

    public static class AttributeNames {
    #foreach($attr in $attrs)
        public static final String ${attr.name.toUpperCase()} = "$attr.localName";
    #end
    }

    public static enum Attribute {
    #foreach($attr in $attrs)
        ${attr.name.toUpperCase()}(new GlowplugAttribute(TABLE_NAME,"$attr.localName","$attr.sqliteType") #if($attr.primaryKey).setPrimaryKey(true)#end),
    #end
        ;

        private GlowplugAttribute attr;
        private Attribute(GlowplugAttribute attr) {
            this.attr = attr;
        }

        public GlowplugAttribute getAttribute() {
            return attr;
        }

        public String getFQName() {
            return attr.getFQName();
        }

        public String toString() {
            return attr.getName();
        }
    }

    public static class RelationshipNames {
    #foreach($relationship in $relationships)
        public static final String ${relationship.name.toUpperCase()} = "$relationship.localName";
    #end
    }

    public static enum Relationship {
    #foreach($relationship in $relationships)
        ${relationship.localName.toUpperCase()}(new GlowplugRelationship(TABLE_NAME,"$relationship.localName","$relationship.foreignTable", "$relationship.foreignKey")),
    #end
        ;

        private GlowplugRelationship relationship;
        private Relationship(GlowplugRelationship relationship) {
            this.relationship = relationship;
        }

        public GlowplugRelationship getRelationship() {
            return relationship;
        }

        public String getFQName() {
            return relationship.getFQName();
        }

        public String toString() {
            return relationship.getName();
        }
    }

    public ${className}Entity() {
    }

    public GlowplugAttribute[] attributes;
    public GlowplugRelationship[] relationships;

    @Override
    public String getName() {
        return TABLE_NAME;
    }

    @Override
    public String getLocalName() {
        return TABLE_NAME;
    }

    @Override
    public String getRemoteName() {
        return TABLE_NAME;
    }

    @Override
    public GlowplugAttribute[] getAttributes() {
        Attribute[] values = Attribute.values();
        if(attributes == null) {
            attributes = new GlowplugAttribute[values.length];
            for(int i=0;i<values.length;i++) {
                attributes[i] = values[i].getAttribute();
            }
        }

        return attributes;
    }

    @Override
    public GlowplugRelationship[] getRelationships() {
        Relationship[] values = Relationship.values();
        if(relationships == null) {
            relationships = new GlowplugRelationship[values.length];
            for(int i=0;i<values.length;i++) {
                relationships[i] = values[i].getRelationship();
            }
        }

        return relationships;
    }

}